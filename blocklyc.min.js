var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
var BlocklyProp={},term=null,graph=null,codePropC=null,codeXml=null,baudrate=115200,graph_temp_data=[],graph_data_ready=!1,graph_connection_string="",graph_timestamp_start=null,graph_timestamp_restart=0,graph_paused=!1,graph_start_playing=!1,graph_temp_string=new String,graph_time_multiplier=0,graph_interval_id=null,fullCycleTime=53.6870912,graph_labels=null,graph_csv_data=[],console_header_arrived=!1,console_header=null,active_connection=null,connString="",connStrYet=!1,graph_options={showPoint:!1,
fullWidth:!0,axisX:{type:Chartist.AutoScaleAxis,onlyInteger:!0},refreshRate:250,sampleTotal:40,graph_type:"S"},graph_data={series:[[],[],[],[],[],[],[],[],[],[]]},minEnc64Ver=version_as_number("0.7.0"),minCodedVer=version_as_number("0.7.5"),minVer=version_as_number(client_min_version);
function tabClick(a){var c=["blocks","propc","xml"];for(b in c)document.getElementById("content_"+c[b]).style.display="none";c=a.replace("tab_","");var b=document.getElementsByClassName("blocklyToolboxDiv");var d=document.getElementsByClassName("btn-view-code");document.getElementById("btn-view-blocks").style.display="none";document.getElementById("menu-save-as-propc")&&(document.getElementById("menu-save-as-propc").style.display="none");for(var e=0;e<d.length;e++)d[e].style.display="none";if("propcfile"!==
projectData.board)if(!0===Blockly.codeOnlyKeybind&&(Blockly.bindEvent_(document,"keydown",null,Blockly.onKeyDown_),Blockly.codeOnlyKeybind=!1),"tab_blocks"===a){for(a=0;a<d.length;a++)d[a].style.display="inline-block";for(a=0;a<b.length;a++)b[a].style.display="block"}else{for(a=0;a<b.length;a++)b[a].style.display="none";document.getElementById("btn-view-blocks").style.display="inline-block";document.getElementById("menu-save-as-propc")&&(document.getElementById("menu-save-as-propc").style.display=
"block")}else Blockly.unbindEvent_(document,"keydown",null,Blockly.onKeyDown_),Blockly.codeOnlyKeybind=!0,"true"===$("meta[name=cdn]").attr("user-auth")&&(document.getElementById("prop-btn-graph").style.display="none",document.getElementById("upload-project").style.display="none"),document.getElementById("prop-btn-pretty").style.display="inline-block",document.getElementById("prop-btn-find-replace").style.display="inline-block",document.getElementById("prop-btn-undo").style.display="inline-block",
document.getElementById("prop-btn-redo").style.display="inline-block",$(".propc-only").removeClass("hidden");document.getElementById("content_"+c).style.display="block";"propcfile"===projectData.board&&"xml"===c&&(getURLParameter("debug")||isOffline)?(document.getElementById("btn-view-propc").style.display="inline-block",document.getElementById("btn-view-xml").style.display="none"):"propcfile"===projectData.board&&"propc"===c&&(getURLParameter("debug")||isOffline)&&(document.getElementById("btn-view-xml").style.display=
"inline-block",document.getElementById("btn-view-propc").style.display="none");renderContent(c)}
function renderContent(a){"blocks"===a&&"propcfile"!==projectData.board?(getURLParameter("debug")||isOffline)&&40<codeXml.getValue().length?(a=Blockly.Xml.textToDom(codeXml.getValue()),Blockly.Xml.clearWorkspaceAndLoadFromXml(a,Blockly.mainWorkspace)):Blockly.mainWorkspace.render():"xml"===a?("propcfile"===projectData.board?a=propcAsBlocksXml():(a=Blockly.Xml.workspaceToDom(Blockly.mainWorkspace),a=Blockly.Xml.domToPrettyText(a)),codeXml.setValue(a),codeXml.getSession().setUseWrapMode(!0),codeXml.gotoLine(0)):
"propc"===a&&"propcfile"!==projectData.board?(a=prettyCode(Blockly.propc.workspaceToCode(Blockly.mainWorkspace)),codePropC.setValue(a),codePropC.gotoLine(0)):"propc"===a&&(codePropC&&""!==codePropC.getValue()||(codePropC.setValue(atob((projectData.code.match(/<field name="CODE">(.*)<\/field>/)||["",""])[1]||"")),codePropC.gotoLine(0)),""===codePropC.getValue()&&(a=prettyCode('// ------ Libraries and Definitions ------\n#include "simpletools.h"\n\n\n// ------ Global Variables and Objects ------\n\n\n// ------ Main Program ------\nint main() {\n\n\nwhile (1) {\n\n\n}}'),
codePropC.setValue(a),codePropC.gotoLine(0)))}
var formatWizard=function(){var a=codePropC.getCursorPosition().row+1;codePropC.setValue(prettyCode());codePropC.focus();codePropC.gotoLine(a)},prettyCode=function(a){a||(a=codePropC.getValue());a=js_beautify(a,{brace_style:"expand",indent_size:2});return a=a.replace(/,\n[\s\xA0]+/g,", ").replace(/, & /g,", &").replace(/, \* /g,", *").replace(/\( & /g,"(&").replace(/\( \* /g,"(*").replace(/char \* /g,"char *").replace(/serial \* /g,"serial *").replace(/lcdParallel \* /g,"lcdParallel *").replace(/colorPal \* /g,
"colorPal *").replace(/ws2812 \* /g,"ws2812 *").replace(/i2c \* /g,"i2c *").replace(/talk \* /g,"talk *").replace(/sound \* /g,"sound *").replace(/FILE \* /g,"FILE* ").replace(/\)\s*[\n\r]\s*{/g,") {").replace(/\[([0-9]*)\]\s*=\s*{\s*([0-9xXbBA-F,\s]*)\s*};/g,function(a,b,d){d=d.replace(/\s/g,"").replace(/,/g,", ");return"["+b+"] = {"+d+"};"})},findReplaceCode=function(){"none"===document.getElementById("find-replace").style.display?document.getElementById("find-replace").style.display="block":document.getElementById("find-replace").style.display=
"none"};function generateBlockId(a){a=btoa(a).replace(/=/g,"");var c=a.length;return a=20>c?"zzzzzzzzzzzzzzzzzzzz".substr(c-20)+a:a.substr(c-20)}
var propcAsBlocksXml=function(){var a='<xml xmlns="http://www.w3.org/1999/xhtml">'+('<block type="propc_file" id="'+generateBlockId(codePropC?codePropC.getValue():"thequickbrownfoxjumpedoverthelazydog")+'" x="100" y="100">');a+='<field name="FILENAME">single.c</field><field name="CODE">';codePropC&&(a+=btoa(codePropC.getValue().replace("/* EMPTY_PROJECT */\n","")));return a+"</field></block></xml>"};
function init(a){codePropC||(codePropC=ace.edit("code-propc"),codePropC.setTheme("ace/theme/chrome"),codePropC.getSession().setMode("ace/mode/c_cpp"),codePropC.getSession().setTabSize(2),codePropC.$blockScrolling=Infinity,codePropC.setReadOnly(!0),"propcfile"===projectData.board&&(codePropC.setReadOnly(!1),codePropC.commands.addCommand({name:"undo",bindKey:{win:"Ctrl-z",mac:"Command-z"},exec:function(a){a.undo()},readOnly:!0}),codePropC.commands.addCommand({name:"redo",bindKey:{win:"Ctrl-y",mac:"Command-y"},
exec:function(a){a.redo()},readOnly:!0}),codePropC.commands.addCommand({name:"find_replace",bindKey:{win:"Ctrl-f",mac:"Command-f"},exec:function(){findReplaceCode()},readOnly:!0}),tabClick("tab_propc")));codeXml||!getURLParameter("debug")&&!isOffline||(codeXml=ace.edit("code-xml"),codeXml.setTheme("ace/theme/chrome"),codeXml.getSession().setMode("ace/mode/xml"));window.Blockly=a;null!==projectData&&(43>projectData.code.length&&(projectData.code='<xml xmlns="http://www.w3.org/1999/xhtml"></xml>'),
"propcfile"!==projectData.board&&loadToolbox(projectData.code))}function setBaudrate(a){baudrate=a}
function cloudCompile(a,c,b){var d="";d=codePropC.getReadOnly()?prettyCode(Blockly.propc.workspaceToCode(Blockly.mainWorkspace)):codePropC.getValue();if(-1<d.indexOf("EMPTY_PROJECT"))alert("You can't compile an empty project");else{$("#compile-dialog-title").text(a);$("#compile-console").val("Compile... ");$("#compile-dialog").modal("show");var e=!1;-1<d.indexOf("SERIAL_TERMINAL USED")?e="term":-1<d.indexOf("SERIAL_GRAPHING USED")&&(e="graph");isOffline?localCompile(c,{"single.c":d},"single.c","-Os",
"-Os",function(a){if(a.error)console.log(a),alert("BlocklyProp was unable to compile your project:\n"+a.message+'\nIt may help to "Force Refresh" by pressing Control-Shift-R (Windows/Linux) or Shift-Command-R (Mac)');else{var f="compile"!==c?"\nDownload...":"";$("#compile-console").val($("#compile-console").val()+a.message+f);a.success&&a.binary&&b(a,e);document.getElementById("compile-console").scrollTop=document.getElementById("compile-console").scrollHeight}}):$.ajax({method:"POST",url:baseUrl+
"rest/compile/c/"+c+"?id="+idProject,data:{code:d}}).done(function(a){if(a.error||"undefined"===typeof a.error)alert("BlocklyProp was unable to compile your project:\n"+("string"===typeof a.message?a.message:"undefined"!==typeof a.error?a.message.toString():"")+'\nIt may help to "Force Refresh" by pressing Control-Shift-R (Windows/Linux) or Shift-Command-R (Mac)');else{var d="compile"!==c?"\nDownload...":"";$("#compile-console").val($("#compile-console").val()+a["compiler-output"]+a["compiler-error"]+
d);a.success&&b(a,e);document.getElementById("compile-console").scrollTop=document.getElementById("compile-console").scrollHeight}}).fail(function(a){alert("BlocklyProp was unable to compile your project:\n----------\n"+("string"===typeof a?a:a.toString())+'\nIt may help to "Force Refresh" by pressing Control-Shift-R (Windows/Linux) or Shift-Command-R (Mac)')})}}function compile(){cloudCompile("Compile","compile",function(a,c){})}
function loadInto(a,c,b,d){ports_available?cloudCompile(a,c,function(a,c){if("ws"===client_use_type){launcher_result="";launcher_download=!1;var e="none";if("term"===c||"graph"===c)e=c;a={type:"load-prop",action:d,payload:a.binary,debug:e,extension:a.extension,portPath:getComPort()};client_ws_connection.send(JSON.stringify(a))}else client_version>=minCodedVer?$.post(client_url+"load.action",{option:b,action:d,binary:a.binary,extension:a.extension,comport:getComPort()},function(a){var d=a.message.replace(/\s{2,}/g,
"\n").split("\n"),e=!0,f="CODE"===b||"CODE_VERBOSE"===b;f&&d.forEach(function(a){e=e&&100>a.substr(0,3)});var g="";if(e&&f)g=" Succeeded.";else{var h=[];d.forEach(function(a){h.push(a.substr(f?4:0))});g=(f?" Failed!":"")+"\n\n-------- loader messages --------\n"+h.join("\n")}$("#compile-console").val($("#compile-console").val()+g);document.getElementById("compile-console").scrollTop=document.getElementById("compile-console").scrollHeight;"term"===c&&a.success?serial_console():"graph"===c&&a.success&&
graphing_console()}):$.post(client_url+"load.action",{action:d,binary:a.binary,extension:a.extension,comport:getComPort()},function(a){$("#compile-console").val($("#compile-console").val()+a.message);document.getElementById("compile-console").scrollTop=document.getElementById("compile-console").scrollHeight;"term"===c&&a.success?serial_console():"graph"===c&&a.success&&graphing_console()})}):client_available?alert("No device detected - ensure it is connected, powered, and selected in the ports list.\n\nMake sure your BlocklyPropClient is up-to-date."):
alert('BlocklyPropClient not available to communicate with a microcontroller.\n\nIt may help to "Force Refresh" by pressing Control-Shift-R (Windows/Linux) or Shift-Command-R (Mac).')}
function serial_console(){var a=!1;if("ws"!==client_use_type)if(null===term&&(term={portPath:getComPort()},a=!0),ports_available){var c=client_url+"serial.connect";c=c.replace("http","ws");var b=new WebSocket(c);b.onopen=function(){connString="";connStrYet=!1;b.send("+++ open port "+getComPort()+(baudrate?" "+baudrate:""));active_connection=b};b.onerror=function(a){console.log("WebSocket Error");console.log(a)};b.onmessage=function(a){var b=client_version>=minEnc64Ver?atob(a.data):a.data;connStrYet?
displayInTerm(b):(connString+=b,-1<connString.indexOf(baudrate.toString(10))?(connStrYet=!0,document.getElementById("serial-conn-info")&&(document.getElementById("serial-conn-info").innerHTML=connString.trim())):displayInTerm(a.data));$("#serial_console").focus()};a||updateTermBox(0);$("#console-dialog").on("hidden.bs.modal",function(){active_connection=null;connString="";connStrYet=!1;b.close();document.getElementById("serial-conn-info")&&(document.getElementById("serial-conn-info").innerHTML="");
updateTermBox(0);term_been_scrolled=!1;term=null})}else active_connection="simulated",a&&(displayInTerm("Simulated terminal because you are in demo mode\n"),displayInTerm("Connection established with: "+getComPort()+"\n")),$("#console-dialog").on("hidden.bs.modal",function(){term_been_scrolled=!1;active_connection=null;updateTermBox(0);term=null});else if("ws"===client_use_type){term={portPath:getComPort()};var d={type:"serial-terminal",outTo:"terminal",portPath:getComPort(),baudrate:baudrate.toString(10),
msg:"none",action:"open"};active_connection="websocket";document.getElementById("serial-conn-info")&&(document.getElementById("serial-conn-info").innerHTML="Connection established with "+d.portPath+" at baudrate "+d.baudrate);client_ws_connection.send(JSON.stringify(d));$("#console-dialog").on("hidden.bs.modal",function(){"close"!==d.action&&(d.action="close",document.getElementById("serial-conn-info")&&(document.getElementById("serial-conn-info").innerHTML=""),active_connection=null,client_ws_connection.send(JSON.stringify(d)));
term_been_scrolled=!1;updateTermBox(0)})}$("#console-dialog").modal("show")}
function graphing_console(){var a=Blockly.propc.workspaceToCode(Blockly.mainWorkspace),c=a.indexOf("// GRAPH_SETTINGS_START:"),b=a.indexOf("// GRAPH_LABELS_START:");if(-1<c&&-1<b){var d=a.indexOf(":GRAPH_SETTINGS_END //")+22;c=a.substring(c,d).split(":")[1].split(",");d=a.indexOf(":GRAPH_LABELS_END //")+20;graph_labels=a.substring(b,d).split(":")[1].split(",");graph_options.refreshRate=Number(c[0]);graph_options.graph_type=c[2];graph_options.axisY=0!==Number(c[3])||0!==Number(c[4])?{type:Chartist.AutoScaleAxis,
low:Number(c[3]),high:Number(c[4]),onlyInteger:!0}:{type:Chartist.AutoScaleAxis,onlyInteger:!0};$("#graph_x-axis_label").css("display","block");graph_options.showPoint=!1;graph_options.showLine=!0;"X"===c[2]&&($("#graph_x-axis_label").css("display","none"),graph_options.axisX=0!==Number(c[5])||0!==Number(c[6])?{type:Chartist.AutoScaleAxis,low:Number(c[5]),high:Number(c[6]),onlyInteger:!0}:{type:Chartist.AutoScaleAxis,onlyInteger:!0},graph_options.showPoint=!0,graph_options.showLine=!1);if("S"===graph_options.graph_type||
"X"===graph_options.graph_type)graph_options.sampleTotal=Number(c[1]);null===graph?(graph_reset(),graph_temp_string="",graph=new Chartist.Line("#serial_graphing",graph_data,graph_options),console.log(graph_options)):graph.update(graph_data,graph_options);if("ws"!==client_use_type&&ports_available){a=client_url+"serial.connect";a=a.replace("http","ws");var e=new WebSocket(a);e.onopen=function(){baudrate?e.send("+++ open port "+getComPort()+" "+baudrate):e.send("+++ open port "+getComPort());graphStartStop("start")};
e.onerror=function(a){console.log("WebSocket Error");console.log(a)};e.onmessage=function(a){a=client_version>=minEnc64Ver?atob(a.data):a.data;connStrYet?graph_new_data(a):(connString+=a,-1<connString.indexOf(baudrate.toString(10))?(connStrYet=!0,document.getElementById("graph-conn-info")&&(document.getElementById("graph-conn-info").innerHTML=connString.trim())):graph_new_data(a))};$("#graphing-dialog").on("hidden.bs.modal",function(){e.close();graphStartStop("stop");connString="";connStrYet=!1;document.getElementById("graph-conn-info").innerHTML=
""})}else if("ws"===client_use_type&&ports_available){var f={type:"serial-terminal",outTo:"graph",portPath:getComPort(),baudrate:baudrate.toString(10),msg:"none",action:"open"};document.getElementById("graph-conn-info")&&(document.getElementById("graph-conn-info").innerHTML="Connection established with "+f.portPath+" at baudrate "+f.baudrate);client_ws_connection.send(JSON.stringify(f));graph_interval_id||graphStartStop("start");$("#graphing-dialog").on("hidden.bs.modal",function(){graphStartStop("stop");
"close"!==f.action&&(f.action="close",document.getElementById("graph-conn-info")&&(document.getElementById("graph-conn-info").innerHTML=""),client_ws_connection.send(JSON.stringify(f)))})}$("#graphing-dialog").modal("show");document.getElementById("btn-graph-play")&&(document.getElementById("btn-graph-play").innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="15"><path d="M5.5,2 L4,2 4,11 5.5,11 Z M8.5,2 L10,2 10,11 8.5,11 Z" style="stroke:#fff;stroke-width:1;fill:#fff;"/></svg>')}else alert("To use the graphing feature, your program must have both a graph initialize block and a graph value block.")}
var graphStartStop=function(a){if("start"===a||"play"===a)graph_new_labels(),graph_interval_id&&clearInterval(graph_interval_id),graph_interval_id=setInterval(function(){graph.update(graph_data);graph_update_labels()},graph_options.refreshRate);else if("stop"===a||"pause"===a)clearInterval(graph_interval_id),graph_interval_id=null;"stop"===a&&(graph_paused=!1,graph_reset(),graph_play("play"));"clear"===a&&graph_reset();"play"===a&&(0===graph_data.series[0].length&&graph_reset(),graph_paused=!1,graph_start_playing=
!0);"pause"===a&&graph_temp_data.slice(-1)[0]&&(graph_paused=!0,graph_temp_string="",graph_time_multiplier=graph_timestamp_start=0,graph_timestamp_restart=graph_temp_data.slice(-1)[0][0])},check_com_ports=function(){"ws"!==client_use_type&&void 0!==client_url&&(client_version>=minVer?$.get(client_url+"ports.json",function(a){set_port_list(a)}).fail(function(){set_port_list()}):set_port_list())},select_com_port=function(a){null!==a&&$("#comPort").val(a);null===$("#comPort").val()&&0<$("#comPort option").size()&&
$("#comPort").val($("#comPort option:first").text())};$(document).ready(function(){check_com_ports()});var getComPort=function(){return $("#comPort").find(":selected").text()};
function downloadPropC(){var a=Blockly.propc.workspaceToCode(Blockly.mainWorkspace);-1<a.indexOf("EMPTY_PROJECT")?alert("You can't download an empty project"):utils.confirm("Downloading a SimpleIDE project","To open your project in SimpleIDE, two files will be downloaded.  They must both be saved in the same folder on your computer.",function(c){c&&utils.prompt("Enter a filename:","Project"+idProject,function(b){if(b){var c=function(){var a=document.createElement("a");document.body.appendChild(a);
a.style="display: none";return function(b,c){b=new Blob([b],{type:"octet/stream"});b=window.URL.createObjectURL(b);a.href=b;a.download=c;a.click();window.URL.revokeObjectURL(b)}}();-1!==b.indexOf(".")&&(b=b.substring(0,b.indexOf(".")));30<=b.length&&(b=b.substring(0,29));b=b.replace(/[\\/:*?"<>|]/g,"_");c(a,b+".c");c(b+".c\n>compiler=C\n>memtype=cmm main ram compact\n>optimize=-Os\n>-m32bit-doubles\n>-fno-exceptions\n>defs::-std=c99\n>-lm\n>BOARD::ACTIVITYBOARD",b+".side")}})})}
function graph_new_data(a){if(-1<a.indexOf("ailed"))$("#graph-conn-info").html(a);else for(k=0;k<a.length;k++)if("\n"===a[k]&&(a[k]="\r"),"\r"===a[k]&&graph_data_ready){if(!graph_paused){graph_temp_data.push(graph_temp_string.split(","));var c=graph_temp_data.length-1,b=Number(graph_temp_data[c][0])||0;b/=1220.703125}graph_timestamp_start&&0!==graph_timestamp_start||(graph_timestamp_start=b,graph_start_playing&&(graph_timestamp_start-=graph_timestamp_restart,graph_timestamp_restart=0));0<c&&!graph_start_playing&&
parseFloat(graph_temp_data[c][0])<parseFloat(graph_temp_data[c-1][1])&&(graph_time_multiplier+=fullCycleTime);graph_start_playing=!1;if(!graph_paused){graph_temp_data[c].unshift(b+graph_time_multiplier-graph_timestamp_start);var d=Math.round(1E4*graph_temp_data[c][0])/1E4+",";if("X"===graph_options.graph_type)for(var e=0,f=2;f<graph_temp_data[c].length;f+=2)d+=graph_temp_data[c][f]+","+graph_temp_data[c][f+1]+",",graph_data.series[e].push({x:graph_temp_data[c][f]||null,y:graph_temp_data[c][f+1]||
null}),graph_temp_data[c][0]>graph_options.sampleTotal&&graph_data.series[e].shift(),e++;else for(f=2;f<graph_temp_data[c].length;f++)d+=graph_temp_data[c][f]+",",graph_data.series[f-2].push({x:graph_temp_data[c][0],y:graph_temp_data[c][f]||null}),graph_temp_data[c][0]>graph_options.sampleTotal&&graph_data.series[f-2].shift();graph_csv_data.push(d.slice(0,-1).split(","));15E3<graph_csv_data.length&&graph_csv_data.shift()}graph_temp_string=""}else graph_data_ready?-1<"-0123456789.,\r\n".indexOf(a[k])&&
(graph_temp_string+=a[k]):"\r"===a[k]&&(graph_data_ready=!0)}function graph_reset(){graph_temp_data.length=0;for(var a=graph_csv_data.length=0;10>a;a++)graph_data.series[a]=[];graph&&graph.update(graph_data,graph_options,!0);graph_temp_string="";graph_timestamp_restart=graph_time_multiplier=graph_timestamp_start=0;graph_data_ready=!1}
function graph_play(a){if(document.getElementById("btn-graph-play")){var c=document.getElementById("btn-graph-play").innerHTML;"play"!==a&&(-1<c.indexOf("pause")||-1===c.indexOf("\x3c!--p"))?(document.getElementById("btn-graph-play").innerHTML='\x3c!--play--\x3e<svg xmlns="http://www.w3.org/2000/svg" width="14" height="15"><path d="M4,3 L4,11 10,7 Z" style="stroke:#fff;stroke-width:1;fill:#fff;"/></svg>',a||graphStartStop("pause")):(document.getElementById("btn-graph-play").innerHTML='\x3c!--pause--\x3e<svg xmlns="http://www.w3.org/2000/svg" width="14" height="15"><path d="M5.5,2 L4,2 4,11 5.5,11 Z M8.5,2 L10,2 10,11 8.5,11 Z" style="stroke:#fff;stroke-width:1;fill:#fff;"/></svg>',
graph_interval_id||a||graphStartStop("play"))}}
function downloadGraph(){utils.prompt("Download Graph Output - Filename:","Graph"+idProject,function(a){if(a){var c=function(){var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";return function(b,c){b=new Blob([b],{type:"octet/stream"});b=window.URL.createObjectURL(b);a.href=b;a.download=c;a.click();window.URL.revokeObjectURL(b)}}(),b=document.getElementById("serial_graphing");b=(new XMLSerializer).serializeToString(b);b=b.replace(/xmlns="http:\/\/www.w3.org\/2000\/xmlns\/"/g,
"");b=b.replace(/foreignObject/g,"text");b=b.replace(/([<|</])a[0-9]+:/g,"$1");b=b.replace(/xmlns: /g,"");b=b.replace(/span/g,"tspan");b=b.replace(/x="10" /g,'x="40" ');b=b.substring(b.indexOf("<svg"),b.length-6);var d=b.indexOf('class="ct-label ct-horizontal ct-end"');d=parseFloat(b.substring(b.indexOf(' y="',d+20)+4,b.indexOf('"',b.indexOf(' y="',d+20)+4)));b=b.replace(new RegExp('y="'+d+'"',"g"),'y="'+(d+12)+'"');d=b.indexOf(">")+1;b=b.substring(0,d)+'<style>.ct-perfect-fourth:after,.ct-square:after{content:"";clear:both}.ct-label{fill:rgba(0,0,0,.4);color:rgba(0,0,0,.4);font-size:.75rem;line-height:1}.ct-grid-background,.ct-line{fill:none}.ct-chart-line .ct-label{display:block;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.ct-chart-donut .ct-label,.ct-chart-pie .ct-label{dominant-baseline:central}.ct-label.ct-horizontal.ct-start{-webkit-box-align:flex-end;-webkit-align-items:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-start;-webkit-justify-content:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.ct-label.ct-horizontal.ct-end{-webkit-box-align:flex-start;-webkit-align-items:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:flex-start;-webkit-justify-content:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.ct-label.ct-vertical.ct-start{-webkit-box-align:flex-end;-webkit-align-items:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-end;-webkit-justify-content:flex-end;-ms-flex-pack:flex-end;justify-content:flex-end;text-align:right;text-anchor:end}.ct-label.ct-vertical.ct-end{-webkit-box-align:flex-end;-webkit-align-items:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-start;-webkit-justify-content:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.ct-grid{stroke:rgba(0,0,0,.2);stroke-width:1px;stroke-dasharray:2px}.ct-point{stroke-width:10px;stroke-linecap:round}.ct-line{stroke-width:4px}.ct-area{stroke:none;fill-opacity:.1}.ct-series-a .ct-line,.ct-series-a .ct-point{stroke: #00f;}.ct-series-a .ct-area{fill:#d70206}.ct-series-b .ct-line,.ct-series-b .ct-point{stroke: #0bb;}.ct-series-b .ct-area{fill:#f05b4f}.ct-series-c .ct-line,.ct-series-c .ct-point{stroke: #0d0;}.ct-series-c .ct-area{fill:#f4c63d}.ct-series-d .ct-line,.ct-series-d .ct-point{stroke: #dd0;}.ct-series-d .ct-area{fill:#d17905}.ct-series-e .ct-line,.ct-series-e .ct-point{stroke-width: 1px;stroke: #f90;}.ct-series-e .ct-area{fill:#453d3f}.ct-series-f .ct-line,.ct-series-f .ct-point{stroke: #f00;}.ct-series-f .ct-area{fill:#59922b}.ct-series-g .ct-line,.ct-series-g .ct-point{stroke:#c0c}.ct-series-g .ct-area{fill:#0544d3}.ct-series-h .ct-line,.ct-series-h .ct-point{stroke:#000}.ct-series-h .ct-area{fill:#6b0392}.ct-series-i .ct-line,.ct-series-i .ct-point{stroke:#777}.ct-series-i .ct-area{fill:#f05b4f}.ct-square{display:block;position:relative;width:100%}.ct-square:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:100%}.ct-square:after{display:table}.ct-square>svg{display:block;position:absolute;top:0;left:0}.ct-perfect-fourth{display:block;position:relative;width:100%}.ct-perfect-fourth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:75%}.ct-perfect-fourth:after{display:table}.ct-perfect-fourth>svg{display:block;position:absolute;top:0;left:0}.ct-line {stroke-width: 1px;}.ct-point {stroke-width: 2px;}text{font-family:sans-serif;}</style>'+
b.substring(d,b.length);c(b,a+".svg")}})}
function downloadCSV(){utils.prompt("Download Graph data as CSV - Filename:","graph_data"+idProject,function(a){if(a){var c=function(){var a=document.createElement("a");document.body.appendChild(a);a.style="display: none";return function(b,c){b=new Blob([b],{type:"octet/stream"});b=window.URL.createObjectURL(b);a.href=b;a.download=c;a.click();window.URL.revokeObjectURL(b)}}(),b=graph_csv_data.join("\n"),d=b.indexOf("\n")+1,e=b.indexOf("\n",d+1);c(b.substring(0,d)+b.substring(e+1,b.length-1),a+".csv")}})}
function graph_new_labels(){var a='<svg width="60" height="300">';var c='"time",';var b=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],d="             ".split(" ");"X"===graph_options.graph_type&&(b=[1,1,2,2,3,3,4,4,5,5,6,6,7,7],d="x: ;y: ;x: ;y: ;x: ;y: ;x: ;y: ;x: ;y: ;x: ;y: ;x: ;y: ".split(";"));for(var e=0;e<graph_labels.length;e++)a+='<g id="labelgroup'+(e+1)+'" transform="translate(0,'+(30*e+25)+')">',a+='<rect x="0" y = "0" width="60" height="26" rx="3" ry="3" id="label'+(e+1)+'" ',a+='style="stroke:1px;stroke-color:blue;" class="ct-marker-'+
b[e]+'"/><rect x="3" y="12"',a+='width="54" height="11" rx="3" ry="3" id="value'+(e+1)+'bkg" style="fill:rgba',a+='(255,255,255,.7);stroke:none;"/><text id="label'+(e+1)+'text" x="3" ',a+='y="9" style="font-family:Arial;font-size: 9px;fill:#fff;font-weight:bold;">'+d[e],a+=graph_labels[e]+'</text><text id="gValue'+(e+1)+'" x="5" y="21" style="align:right;',a+='font-family:Arial;font-size: 10px;fill:#000;"></text></g>',c+='"'+graph_labels[e].replace(/"/g,"_")+'",';a+="</svg>";graph_csv_data.push(c.slice(0,
-1));$("#serial_graphing_labels").html(a)}function graph_update_labels(){var a=graph_temp_data.length-1;if(graph_temp_data[a])for(var c=graph_temp_data[a].length,b=2;b<c;b++){var d=document.getElementById("gValue"+(b-1).toString(10));d&&(d.textContent=graph_temp_data[a][b])}};
